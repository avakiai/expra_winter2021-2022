
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Demo Experiment Analysis, Part II &#8212; EXPRA Team 6 2021-2022</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Projects" href="../projects/projects.html" />
    <link rel="prev" title="Demo Experiment Analysis, Part I" href="yannylaurel_analysis_v1.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/Logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">EXPRA Team 6 2021-2022</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   Welcome to EXPRA!
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../course_overview.html">
   Course overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../syllabus.html">
   Syllabus
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../setup.html">
   Setup for the course
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../lectures/landing.html">
   Lectures &amp; Workshops
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../lectures/lectures.html">
     Lectures
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lectures/workshops.html">
     Workshops
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../open_science.html">
   Open Science
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="demo_exp.html">
   Demo Experiment
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="yannylaurel_analysis_v1.html">
     Demo Experiment Analysis, Part I
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Demo Experiment Analysis, Part II
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../projects/projects.html">
   Projects
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../projects/repeated_presentation.html">
     Repeated Presentation Experiment
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../projects/vocal_adaptation.html">
     Vocal Adaptation Experiment
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../experimentation/landing.html">
   Experimentation
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../experimentation/experimentation.html">
     Experimentation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../experimentation/data_analyses.html">
     Data Analyses
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../finalization/landing.html">
   Finalization
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../finalization/finalization.html">
     Finalization
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/demo/yannylaurel_analysis2_v1.Rmd"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.Rmd</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/avakiai/expra_winter2021-2022"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/avakiai/expra_winter2021-2022/issues/new?title=Issue%20on%20page%20%2Fdemo/yannylaurel_analysis2_v1.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Demo Experiment Analysis, Part II
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#set-paths-and-load-libraries">
     Set paths and load libraries
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#load-data">
     Load Data
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#reaction-times">
     1. Reaction Times
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#outlier-removal">
       Outlier removal
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#summary-statistics">
       Summary statistics
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#plot">
       Plot
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#plain-linear-regression">
       2. Plain Linear Regression
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#predicted-vs-observed-values">
         Predicted vs. Observed Values
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#polynomial-regression">
       3. Polynomial Regression
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#model-performance">
         Model Performance
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#model-comparison">
       Model Comparison
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#writing-it-up">
       Writing it up…
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#resources">
   Resources
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="demo-experiment-analysis-part-ii">
<h1>Demo Experiment Analysis, Part II<a class="headerlink" href="#demo-experiment-analysis-part-ii" title="Permalink to this headline">¶</a></h1>
<p>Alright, so we’ve evaluated our main hypothesis in the last script (whether dB level, and also individual factors affect the proportion of times participants hear “Yanny” over “Laurel”).</p>
<p>Now let’s look at reaction times to evaluate our secondary hypothesis, that smaller dB ratios will yield longer RTs.
To do this, we said
we use a polynomial regression. However, we are also going to check out what linear regression
has to say about this data.</p>
<p>First, setup the script…</p>
<div class="section" id="set-paths-and-load-libraries">
<h2>Set paths and load libraries<a class="headerlink" href="#set-paths-and-load-libraries" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data_path</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">path</span><span class="p">(</span><span class="s1">&#39;../data&#39;</span><span class="p">)</span> 
<span class="n">results_path</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">path</span><span class="p">(</span><span class="s1">&#39;../3_results&#39;</span><span class="p">)</span>

<span class="n">library</span><span class="p">(</span><span class="n">tidyverse</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="load-data">
<h2>Load Data<a class="headerlink" href="#load-data" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">&lt;-</span> <span class="n">read</span><span class="o">.</span><span class="n">csv</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">path</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span><span class="s2">&quot;data.csv&quot;</span><span class="p">),</span> <span class="n">row</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span> <span class="n">NULL</span><span class="p">,</span> <span class="n">colClasses</span><span class="o">=</span><span class="n">c</span><span class="p">(</span><span class="s2">&quot;participant&quot;</span> <span class="o">=</span> <span class="s2">&quot;factor&quot;</span><span class="p">,</span> <span class="s2">&quot;sex&quot;</span> <span class="o">=</span> <span class="s2">&quot;factor&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="reaction-times">
<h2>1. Reaction Times<a class="headerlink" href="#reaction-times" title="Permalink to this headline">¶</a></h2>
<p>From our preregistration:</p>
<p>“We will exclude particularly slow and particularly fast responses, defined as median +- 3 * the median absolute deviation (MAD). However if this procedure eliminates more than 5% of observations, we will opt for a factor to multiply the MAD by, that allows for retention of at least 95% of the data.”</p>
<div class="section" id="outlier-removal">
<h3>Outlier removal<a class="headerlink" href="#outlier-removal" title="Permalink to this headline">¶</a></h3>
<p>Let’s find out if we have outliers based on our pre-registered criteria! What was that again?</p>
<blockquote>
<div><p>“We will exclude particularly slow and particularly fast responses, defined as median +- 3 * the median absolute deviation (MAD). However if this procedure eliminates more than 5% of observations, we will opt for a factor to multiply the MAD by, that allows for retention of at least 95% of the data.”
Let’s start by visualizing the distribution and summary statistics of our RT data.</p>
</div></blockquote>
<p>Your turn: check out whether we can use our baseline criteria for outlier removal and
maintain our threshold for data loss.</p>
<p>If it’s too high, follow the procedure we outlined to get an acceptable cutoff.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>hist(data$RT, breaks = 50)
summary(data$RT)

too_short &lt;- which(data$RT&lt;median(data$RT)-3*mad(data$RT)) 
too_long &lt;- which(data$RT&gt;median(data$RT)+3*mad(data$RT))
data2 &lt;- data[-too_long,]
length(data2$RT)/length(data$RT)

too_short &lt;- which(data$RT&lt;median(data$RT)-6*mad(data$RT)) 
too_long &lt;- which(data$RT&gt;median(data$RT)+6*mad(data$RT))
data3 &lt;- data[-too_long,]
length(data3$RT)/length(data$RT)

#... we tried several factors, and decided on doing a strict cut-off of the data at 95%:
keep_N &lt;- ceiling(length(data$RT) * 0.95)
#sort(data$RT) 
data_or_interm &lt;- data %&gt;% arrange(RT)
data_or &lt;- data_or_interm[1:keep_N,]

# caluclate the factor
(max(data_or$RT)-median(data$RT)) / mad(data$RT) 

ggplot() +
   geom_histogram(data, mapping = aes(RT), fill = &#39;lightblue&#39;, alpha = 0.8) + 
   geom_histogram(data_or, mapping = aes(RT), fill = &#39;orange&#39;, alpha = 0.5)
</pre></div>
</div>
</div>
</div>
<p>Since a factor of 5 * the mad cuts off a bit too much data (~ 94%), but a factor of 6 leaves quite a few outliers remaining (18),
we decided to implement a strict cut off of the data by keeping only the first 95% of sorted RT values.
This corresponds to cut-off of ~ 5.32 * the mad.</p>
</div>
<div class="section" id="summary-statistics">
<h3>Summary statistics<a class="headerlink" href="#summary-statistics" title="Permalink to this headline">¶</a></h3>
<p>Let’s look at some summary statistics:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>summary(data_or$RT)
</pre></div>
</div>
</div>
</div>
<p>How do we expect the data to look, broken down by participant and dB level?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">RTdata</span> <span class="o">&lt;-</span> <span class="n">data_or</span> <span class="o">%&gt;%</span> <span class="n">group_by</span><span class="p">(</span><span class="n">participant</span><span class="p">,</span> <span class="n">dB_ratio</span><span class="p">)</span> <span class="o">%&gt;%</span>
                  <span class="n">summarise</span><span class="p">(</span><span class="n">median</span> <span class="o">=</span> <span class="n">median</span><span class="p">(</span><span class="n">RT</span><span class="p">),</span>
                            <span class="n">mad</span> <span class="o">=</span> <span class="n">mad</span><span class="p">(</span><span class="n">RT</span><span class="p">),</span>
                            <span class="n">quant</span> <span class="o">=</span> <span class="n">IQR</span><span class="p">(</span><span class="n">RT</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="plot">
<h3>Plot<a class="headerlink" href="#plot" title="Permalink to this headline">¶</a></h3>
<p>We’ll use <a class="reference external" href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot()</a> to visualize the summary statistics of RTs for each level of our dB manipulation.</p>
<p>We’ll also visualize the raw data by plotting the points with geom_point().</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ggplot</span><span class="p">(</span><span class="n">data_or</span><span class="p">)</span> <span class="o">+</span> 
  <span class="n">geom_boxplot</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">dB_ratio</span><span class="p">,</span> <span class="n">RT</span><span class="p">,</span> <span class="n">group</span> <span class="o">=</span> <span class="n">dB_ratio</span><span class="p">),</span> <span class="n">width</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span> <span class="o">+</span> 
  <span class="n">geom_point</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">dB_ratio</span><span class="p">,</span> <span class="n">RT</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">participant</span><span class="p">))</span> <span class="o">+</span>
  <span class="n">scale_x_continuous</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;High/low dB ratio&quot;</span><span class="p">)</span> <span class="o">+</span>
  <span class="n">scale_color_brewer</span><span class="p">(</span><span class="n">palette</span> <span class="o">=</span> <span class="s2">&quot;Dark2&quot;</span><span class="p">)</span> <span class="o">+</span>
  <span class="n">theme_bw</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Challenge! Use <a class="reference external" href="https://github.com/RainCloudPlots/RainCloudPlots">Raincloud</a> plots to also add a “half violin” to the side of each boxplot. Then, you’ll be visualizing the raw data, summary stats, and the distribution of responses for each level of dB.</p>
</div>
<div class="section" id="plain-linear-regression">
<h3>2. Plain Linear Regression<a class="headerlink" href="#plain-linear-regression" title="Permalink to this headline">¶</a></h3>
<p>Now, we’re going to model the effect of dB level (or stim_idx, doesn’t matter here…).
What happens if we do a simple linear regression?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">RTmodel1</span> <span class="o">&lt;-</span> <span class="n">lm</span><span class="p">(</span><span class="n">RT</span> <span class="o">~</span> <span class="n">stim_idx</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">data_or</span><span class="p">)</span>

<span class="n">summary</span><span class="p">(</span><span class="n">RTmodel1</span><span class="p">)</span>

<span class="n">plot</span><span class="p">(</span><span class="n">RTmodel1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">plot()</span></code> function from base R has an interesting behavior when it comes to model objects:
it generates a bunch of diagnostic plots to help us determine if our model is a good fit
for the data. Take a look at the plots and online - what are each of these plots telling us?</p>
<div class="section" id="predicted-vs-observed-values">
<h4>Predicted vs. Observed Values<a class="headerlink" href="#predicted-vs-observed-values" title="Permalink to this headline">¶</a></h4>
<p>As before, let’s visualize the predicted values from the model against our observed values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
predicted &lt;- data.frame(RT_pred = predict(RTmodel1, data_or), dB_ratio=data_or$dB_ratio)

ggplot(data_or, aes(dB_ratio, RT)) +
  geom_pointrange(stat = &quot;summary&quot;,
               fun.min = function(z) {quantile(z,0.25)},
               fun.max = function(z) {quantile(z,0.75)},
               fun = median) +
  geom_line(color=&#39;red&#39;,data = predicted, aes(x=dB_ratio, y=RT_pred)) + 
  stat_smooth(method=&#39;lm&#39;, formula = y ~ x, size = 1) 

</pre></div>
</div>
</div>
</div>
<p>Does this look like a good fit for the model?</p>
<p>A plain linear regression assumed a linear <em>relationship</em> between the predictor and
outcome variable. But that’s not actually the relationship we observe, is it?</p>
<p>We predicted this too! We wrote:</p>
<blockquote>
<div><p>“To determine whether RTs are modulated by dB ratio (for the purposes of our study, an index of stimulus ambiguity), we will perform a polynomial linear regression with RTs as outcome variable and dB ratio as predictor.”</p>
</div></blockquote>
</div>
</div>
<div class="section" id="polynomial-regression">
<h3>3. Polynomial Regression<a class="headerlink" href="#polynomial-regression" title="Permalink to this headline">¶</a></h3>
<p>Polynomial regression requires us to state the polynomial degree that defines the relationship
of the predictor to the outcome variable.</p>
<p>Each time you add a degree, you can imagine you add another
bend to the curve that we hope will capture the relationship between x and y, or dB ratio and responses.</p>
<p>Need a refresher on polynomial regression? Try <a class="reference external" href="https://towardsdatascience.com/introduction-to-linear-regression-and-polynomial-regression-f8adc96f31cb">this</a>.</p>
<p>So let’s give it a try:</p>
<p>In R, you can define that a predictor will be treated as a polynomial by wrapping the function
<code class="docutils literal notranslate"><span class="pre">poly()</span></code> around the variable. The second argument to <code class="docutils literal notranslate"><span class="pre">poly()</span></code> is the polynomial order.</p>
<p>Go ahead and try this out. Visualize the predicted values, and play around with different
orders…</p>
<p>Let’s give the polynomial regression that we planned in the pre-registration a chance. Since polynomial order = 1 is the
same as linear regression, and as we increase the order, we risk overfitting fast, let’s start with an order = 2.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>RTmodel2 &lt;- lm(RT ~ poly(stim_idx,2), data = data_or)

summary(RTmodel2)

plot(RTmodel2)

# for plotting &amp; calculating RSME
predicted2 &lt;- data.frame(RT_pred = predict(RTmodel2, data_or), dB_ratio=data_or$dB_ratio)
</pre></div>
</div>
</div>
</div>
<p>What’s nice about the <code class="docutils literal notranslate"><span class="pre">lm()</span></code> function here is that it gives us separate coefficients and their test
statistics for each polynomial order. This can help us figure out which order is contributing the most
towards capturing the variance in the data.</p>
<p>Let’s quickly see what happens if we try different polynomial orders. Pay
attention to the formula in the <code class="docutils literal notranslate"><span class="pre">stat_smooth()</span></code> layer of this <code class="docutils literal notranslate"><span class="pre">ggplot()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ggplot</span><span class="p">(</span><span class="n">data_or</span><span class="p">,</span> <span class="n">aes</span><span class="p">(</span><span class="n">dB_ratio</span><span class="p">,</span> <span class="n">RT</span><span class="p">))</span> <span class="o">+</span>
   <span class="n">geom_pointrange</span><span class="p">(</span><span class="n">stat</span> <span class="o">=</span> <span class="s2">&quot;summary&quot;</span><span class="p">,</span>
                <span class="n">fun</span><span class="o">.</span><span class="n">min</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="p">{</span><span class="n">quantile</span><span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="mf">0.25</span><span class="p">)},</span>
                <span class="n">fun</span><span class="o">.</span><span class="n">max</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="p">{</span><span class="n">quantile</span><span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="mf">0.75</span><span class="p">)},</span>
                <span class="n">fun</span> <span class="o">=</span> <span class="n">median</span><span class="p">)</span> <span class="o">+</span>
   <span class="c1">#geom_line(color=&#39;red&#39;,data = predicted2, aes(x=dB_ratio, y=RT_pred)) + </span>
   <span class="n">stat_smooth</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;lm&#39;</span><span class="p">,</span> <span class="n">formula</span> <span class="o">=</span> <span class="n">y</span> <span class="o">~</span> <span class="n">poly</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">)</span> <span class="o">+</span>
   <span class="n">stat_smooth</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;lm&#39;</span><span class="p">,</span> <span class="n">formula</span> <span class="o">=</span> <span class="n">y</span> <span class="o">~</span> <span class="n">poly</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.6</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;blue&quot;</span><span class="p">)</span> <span class="o">+</span>
   <span class="n">stat_smooth</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;lm&#39;</span><span class="p">,</span> <span class="n">formula</span> <span class="o">=</span> <span class="n">y</span> <span class="o">~</span> <span class="n">poly</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.6</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;green&quot;</span><span class="p">)</span> <span class="o">+</span>
   <span class="n">stat_smooth</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;lm&#39;</span><span class="p">,</span> <span class="n">formula</span> <span class="o">=</span> <span class="n">y</span> <span class="o">~</span> <span class="n">poly</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.6</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;orange&quot;</span><span class="p">)</span> 
</pre></div>
</div>
</div>
</div>
<p>As before, we’re interested in the coefficients and their confidence intervals.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">coef</span><span class="p">(</span><span class="n">RTmodel2</span><span class="p">)</span>

<span class="n">confint</span><span class="p">(</span><span class="n">RTmodel2</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>How do we interpret the polynomial coefficients?</p>
<p>The predicted reaction time for a given dB level is given by the following equation:</p>
<p>$$RT = the intercept + first order polynomial* (dB level) + second order polynomial* (dB level)^2$$</p>
<div class="section" id="model-performance">
<h4>Model Performance<a class="headerlink" href="#model-performance" title="Permalink to this headline">¶</a></h4>
<p>The <a class="reference external" href="https://www.r-bloggers.com/2021/07/how-to-calculate-root-mean-square-error-rmse-in-r/">Root Mean Square Error</a> is a useful metric to evaluate the goodness-of-fit of a linear model.
Let’s break down the phrase from the end:</p>
<ul class="simple">
<li><p>we take the error: the difference between each observed and predicted value,</p></li>
<li><p>square it,</p></li>
<li><p>take the mean of those squared errors,</p></li>
<li><p>then take the square root of that mean.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span># RSME for RTmodel2
sqrt(mean( (data_or$resp - predicted2$RT_pred)^2 ) )
</pre></div>
</div>
</div>
</div>
<p>In addition, compare the RMSE values for the models you fit:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>sqrt(mean( (data_or$resp - predicted$RT_pred)^2 ) )
</pre></div>
</div>
</div>
</div>
<p>Which has the lowest error? Well, they’re really the same actually. It looks like neither model is doing an excellent job of
fitting the data, yet when looking at the data we can see why. There does not appear to be a clear pattern, or at least, not one we
can observe with our sample size of 7 and the few trials we had per stimulus.</p>
</div>
</div>
<div class="section" id="model-comparison">
<h3>Model Comparison<a class="headerlink" href="#model-comparison" title="Permalink to this headline">¶</a></h3>
<p>Think back to the last tutorial: what does model comparison using a Chi-square tell you?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">anova</span><span class="p">(</span><span class="n">RTmodel1</span><span class="p">,</span> <span class="n">RTmodel2</span><span class="p">,</span> <span class="n">test</span> <span class="o">=</span> <span class="s2">&quot;Chisq&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>What is the interpretation of this result in plain English?</p>
</div>
<div class="section" id="writing-it-up">
<h3>Writing it up…<a class="headerlink" href="#writing-it-up" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="https://www.statisticssolutions.com/reporting-statistics-in-apa-format/">Values</a> to report: R^2, F value (F), degrees of freedom (numerator, denominator; in parentheses separated by a comma next to F), and significance level (p), β. Report the β and the corresponding t-test for that predictors for each predictor in the regression</p>
<p>For Example:
“A polynomial regression analysis was used to test if the dB ratio level significantly
predicted participants’ reaction times to the Yanny/Laurel 2AFC task. The results of the regression indicated the predictor “dB ratio” explained __ % of the variance (R2 = <strong>, F( <strong>,</strong>)=</strong>, p __ ). It was found that __ [did not/significantly predict/ed RT (β = __, p __ ).”</p>
</div>
</div>
</div>
<div class="section" id="resources">
<h1>Resources<a class="headerlink" href="#resources" title="Permalink to this headline">¶</a></h1>
<p>A great reference for modelling RTs <a class="reference external" href="https://lindeloev.github.io/shiny-rt/#1_opinion:_three_important_types_of_parameters">here.</a></p>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./demo"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="yannylaurel_analysis_v1.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Demo Experiment Analysis, Part I</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../projects/projects.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Projects</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Ava Kiai<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>